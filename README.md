# 📊 Excel 数据管理器

一个基于Web技术的Excel/CSV数据筛选和导出工具，支持多种文件格式和智能数据处理功能。

## 🔄 更新记录

### v1.2.0 - 2025年6月24日
**🧮 新增列计算器功能**
- ✅ 添加列与列之间的计算功能
- ✅ 支持数值计算：加法、减法、乘法、除法、百分比
- ✅ 支持文本操作：连接文本，支持自定义分隔符
- ✅ 智能列类型识别（数值列/文本列）
- ✅ 实时计算预览功能
- ✅ 计算列可参与后续计算（链式计算）
- ✅ 计算列管理：查看已创建的计算列，支持删除
- ✅ 计算列可参与筛选和导出
- ✅ 计算公式显示，便于追踪计算逻辑
- 🔧 修复了计算列无法重新代入计算的问题
- 🎨 优化了计算器界面设计，添加视觉标识

### v1.1.0 - 2025年6月23日
**🔍 增强筛选功能**
- ✅ 新增4种匹配模式（精确/精确忽略大小写/包含/包含忽略大小写）
- ✅ 优化多项搜索，支持中英文逗号分隔
- ✅ 新增AND/OR逻辑模式选择
- ✅ 改进了多列选择界面
- 🐛 修复了CSV编码识别问题

### v1.0.0 - 2025年6月22日
**🎉 初始版本发布**
- ✅ 基础文件上传和解析功能
- ✅ 多列筛选功能
- ✅ CSV和Excel导出
- ✅ 数据预览和统计

---

## ✨ 主要功能

### 📁 文件处理
- **多格式支持**：支持 `.xlsx`、`.xls`、`.csv` 格式
- **智能编码检测**：自动检测CSV文件编码（UTF-8、GBK、GB2312、GB18030）
- **拖拽上传**：支持文件拖拽到页面直接上传
- **文件信息展示**：显示文件大小、行数、列数等统计信息

### 🧮 列计算器 ⭐ **新功能**
- **数值计算**：支持加法、减法、乘法、除法、百分比计算
- **文本操作**：支持文本连接，可自定义分隔符
- **智能识别**：自动区分数值列和文本列
- **链式计算**：计算列可作为下次计算的输入
- **实时预览**：计算前预览结果，确保准确性
- **计算管理**：查看和删除已创建的计算列
- **公式追踪**：显示计算公式，便于理解数据来源

### 🔍 数据筛选
- **多列选择**：支持选择多个列进行筛选
- **智能列推荐**：自动识别可能的筛选列
- **增强匹配模式**：
  - 精确匹配（完全相等）
  - 精确匹配（忽略大小写）
  - 包含匹配（广义搜索）
  - 包含匹配（忽略大小写）
- **智能多项搜索**：支持中英文逗号分隔的多个搜索词
- **逻辑组合**：AND（同时包含）/ OR（包含任一）逻辑

### 📊 数据预览
- **实时统计**：显示总行数、总列数等信息
- **数据预览表格**：展示筛选结果，高亮显示选中列
- **筛选结果计数**：实时显示匹配的数据量

### 💾 数据导出
- **CSV导出**：标准CSV格式，支持中文编码
- **Excel兼容导出**：生成Excel可直接打开的CSV文件
- **选择性导出**：仅导出选中的列（包括计算列）
- **自定义文件名**：支持自定义导出文件名

## 🚀 快速开始

### 方式一：直接使用（推荐）
1. 下载项目文件
2. 在浏览器中打开 `browser.html` 文件
3. 开始使用！

### 方式二：本地服务器运行
```bash
# 如果您有Node.js环境
npx serve .
# 然后访问 http://localhost:3000
```

### 方式三：Electron桌面应用（如果已配置）
```bash
# 需要先安装依赖
npm install
# 启动应用
npm start
```

## 📖 使用指南

### 第一步：上传文件
1. 点击"选择文件"按钮选择Excel/CSV文件
2. 或者直接拖拽文件到上传区域
3. 系统会自动解析文件并显示基本信息

### 第二步：创建计算列（可选）⭐ **新功能**
1. 点击"🧮 列计算器"按钮打开计算器
2. 选择计算类型（数值计算/文本操作）
3. 选择要计算的两个列
4. 选择运算类型（加减乘除或文本连接）
5. 输入新列名，点击"预览计算"查看结果
6. 确认无误后点击"执行计算"创建新列
7. 新创建的列可以参与下一步的筛选或再次计算

### 第三步：选择筛选条件
1. 系统会显示所有可用的列（包括计算列）
2. 选择要用于筛选的列
3. 选择匹配模式（精确/包含，是否忽略大小写）
4. 选择多项搜索的逻辑模式（AND/OR）
5. 输入搜索内容（支持中英文逗号分隔）

### 第四步：执行筛选
1. 点击"🔍 智能筛选"按钮
2. 查看筛选结果预览
3. 确认结果是否符合预期

### 第五步：导出数据
1. 输入导出文件名
2. 选择导出格式（CSV或Excel兼容）
3. 点击导出按钮，文件将自动下载

## 🛠️ 实际项目结构

```
数据搜索重组/
├── excel-manager-app/
│   ├── src/
│   │   ├── main/
│   │   │   ├── main.js          # Electron主进程
│   │   │   └── preload.js       # 预加载脚本
│   │   └── renderer/
│   │       ├── index.html       # 主界面文件（模块化版本）
│   │       ├── app.js          # 主应用逻辑
│   │       ├── modules/        # 功能模块
│   │       │   ├── FileHandler.js
│   │       │   ├── DataProcessor.js
│   │       │   ├── UIManager.js
│   │       │   ├── DataExporter.js
│   │       │   └── ColumnCalculator.js  # 🧮 新增：列计算器
│   │       └── styles/
│   │           └── main.css     # 样式文件
│   └── package.json            # 项目配置
├── browser.html                # 浏览器版本（单文件）
└── README.md                   # 项目说明
```

## 💡 技术特点

### 🎨 现代化界面
- 响应式设计，适配不同屏幕尺寸
- 现代CSS变量系统
- 流畅的用户交互体验
- 直观的计算器界面设计

### 🔧 纯前端实现
- 无需服务器，纯浏览器运行
- 数据处理完全在本地进行
- 使用SheetJS库处理Excel文件
- 智能算法进行列类型识别

### ⚡ 高性能处理
- 基于JavaScript的高效文件读取和处理
- 支持大部分常见的Excel和CSV格式
- 实时数据筛选和预览
- 链式计算支持复杂数据处理

## 💻 使用示例

### 计算列示例
```
原始数据：
姓名    | 语文成绩 | 数学成绩
张三    | 85      | 90
李四    | 78      | 82

创建计算列"总分" = 语文成绩 + 数学成绩：
姓名    | 语文成绩 | 数学成绩 | 总分
张三    | 85      | 90      | 175
李四    | 78      | 82      | 160

再创建计算列"平均分" = 总分 ÷ 2：
姓名    | 语文成绩 | 数学成绩 | 总分 | 平均分
张三    | 85      | 90      | 175 | 87.5
李四    | 78      | 82      | 160 | 80
```

## 📋 依赖说明

项目使用的外部库：
- **SheetJS (xlsx)**: 用于处理Excel文件，通过CDN引入
- **现代浏览器**: 支持ES6+特性的浏览器

## 🌐 浏览器兼容性

- Chrome 60+
- Firefox 55+
- Safari 12+
- Edge 79+

## ⚠️ 使用限制

1. **文件大小限制**：建议单个文件不超过50MB
2. **浏览器限制**：需要现代浏览器支持File API
3. **本地运行**：所有数据处理都在浏览器本地进行，不会上传到服务器
4. **计算精度**：浮点数计算可能存在精度问题，建议用于一般计算场景

## 🔧 开发说明

如果您想修改或扩展功能：

1. **浏览器版本**：直接修改 `browser.html` 文件
2. **模块化版本**：
   - 主要逻辑在 `src/renderer/app.js` 文件中
   - 样式定义在 `src/renderer/styles/main.css` 中
   - 各功能模块在 `src/renderer/modules/` 目录下
   - 计算器功能在 `ColumnCalculator.js` 中

## 🐛 已知问题

1. 某些复杂的Excel格式可能解析不完全
2. 非常大的文件可能导致浏览器响应缓慢
3. 除法计算时需要注意除零错误
4. 浮点数计算可能存在精度问题

## 🔮 未来计划

- [ ] 添加更多数学函数（平方根、幂运算等）
- [ ] 支持条件计算（IF函数）
- [ ] 添加统计函数（平均值、最大值、最小值）
- [ ] 支持日期计算
- [ ] 添加数据可视化图表
- [ ] 支持数据排序功能

## 📄 许可证

本项目采用 MIT 许可证

---

**注意**：这是一个纯前端应用，可以直接在浏览器中运行，无需复杂的安装过程。
[![计算器功能演示](https://img.shields.io/badge/新功能-列计算器-brightgreen)](browser.html)